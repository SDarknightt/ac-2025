package org.example.dayseven;

import java.util.ArrayList;
import java.util.Arrays;

public class DaySeven {
    long totalDividedTimes = 0;

    public static void main(String[] args) {
        String inputReal = """
                ......................................................................S......................................................................
                .............................................................................................................................................
                ......................................................................^......................................................................
                .............................................................................................................................................
                .....................................................................^.^.....................................................................
                .............................................................................................................................................
                ....................................................................^.^.^....................................................................
                .............................................................................................................................................
                ...................................................................^.^...^...................................................................
                .............................................................................................................................................
                ..................................................................^.^.^.^.^..................................................................
                .............................................................................................................................................
                .................................................................^.^.^...^.^.................................................................
                .............................................................................................................................................
                ................................................................^.^.^...^.^.^................................................................
                .............................................................................................................................................
                ...............................................................^...^...^.^.^.^...............................................................
                .............................................................................................................................................
                ..............................................................^.^.^...^...^.^.^..............................................................
                .............................................................................................................................................
                .............................................................^.^.^...^.^...^.^.^.............................................................
                .............................................................................................................................................
                ............................................................^.....^.^.^.^.^.^.^.^............................................................
                .............................................................................................................................................
                ...........................................................^...^.^...^.^...^...^.^...........................................................
                .............................................................................................................................................
                ..........................................................^.^.^.^.^...^...^.^.....^..........................................................
                .............................................................................................................................................
                .........................................................^.^.^...^.^.^...^...^.....^.........................................................
                .............................................................................................................................................
                ........................................................^.^.....^.^.^.^.^.^.^.^.^...^........................................................
                .............................................................................................................................................
                .......................................................^...^.^.^.^.^...^...^.^...^.^.^.......................................................
                .............................................................................................................................................
                ......................................................^.^.^.^...^.......^...^.....^.^.^......................................................
                .............................................................................................................................................
                .....................................................^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.....................................................
                .............................................................................................................................................
                ....................................................^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^.^....................................................
                .............................................................................................................................................
                ...................................................^.^.....^.^.^...^...^.^.^.^...^.......^...................................................
                .............................................................................................................................................
                ..................................................^...^.......^.....^...^.^.^.^.^.^...^...^..................................................
                .............................................................................................................................................
                .................................................^.^.^.....^.^.^.^...^.^...^.^.^.^.^...^.^.^.................................................
                .............................................................................................................................................
                ................................................^.^.^...^.^...^.^.......^...^...^.^.^.^.^.^.^................................................
                .............................................................................................................................................
                ...............................................^.........^...^.^.......^.....^.^.^...^.^.^.^.^...............................................
                .............................................................................................................................................
                ..............................................^.^.^.^.^.^...^.^.....^...^.^.^...^...^.^...^.^.^..............................................
                .............................................................................................................................................
                .............................................^...^.^.^.......^.....^.^.^.^...^.^.....^.^.....^.^.............................................
                .............................................................................................................................................
                ............................................^...^...^.^.^...^...^.^.^...^...^.....^.^.^.^.^.^.^.^............................................
                .............................................................................................................................................
                ...........................................^.....^...^.....^...^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...........................................
                .............................................................................................................................................
                ..........................................^.^.^...^...^.^.....^...^.......^.^...^.^.^.^...^.^...^.^..........................................
                .............................................................................................................................................
                .........................................^.^.^...^...^.^.^.^...^.^...^.^.^.^...^.....^.^.^.^.^...^.^.........................................
                .............................................................................................................................................
                ........................................^.^.^...^...^.^.^.^.....^.^.......^.....^...^.^.^.^.^.....^.^........................................
                .............................................................................................................................................
                .......................................^.^.^...^.^.^...^.^.^.^.^.^...^.^...^.^.^.........^.^.^.....^.^.......................................
                .............................................................................................................................................
                ......................................^.^.^...^.....^.^.^.^.....^...^.......^.^.....^.^.^...^...^...^.^......................................
                .............................................................................................................................................
                .....................................^.^.^.^...^.....^.....^.^.^.^.....^.^.^.....^.^...............^...^.....................................
                .............................................................................................................................................
                ....................................^.^.^.^.....^.^.^...^...^.....^.^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^....................................
                .............................................................................................................................................
                ...................................^...^.^...^.....^.^...^...^.^.^.^...^...^.....^.....^.^...^.^.^...^.^.^...................................
                .............................................................................................................................................
                ..................................^.^.^.^.......^...^.^.^.^...^.....^.^...^.^.^...^.^.^.^.^.^.^...^.^...^.^..................................
                .............................................................................................................................................
                .................................^.....^.^.^.....^.....^.^.^.^.^.^...^.........^.^.^.^.^.....^...^.^.^.^...^.................................
                .............................................................................................................................................
                ................................^.^.^.^.^.^.^.^...^.^.......^.^.....^.^.^.^...^...^.^.^.......^...^.......^.^................................
                .............................................................................................................................................
                ...............................^.^...^.^...^...^.^.^.^.^...^.^...^.^...^...^...^...^.^.^.^.^.^...^...^.^...^.^...............................
                .............................................................................................................................................
                ..............................^.^...^.^...^...^...^.^.^.^...^...^.^.....^.^...^.^.^...^.^.^.^...^.^.^.^.^.^.^.^..............................
                .............................................................................................................................................
                .............................^.^.........^.^.^.....^.^.^...^.^.^.^.^.^.^...^...^.^...^...^.^.....^.^.^.^.^.^.^.^.............................
                .............................................................................................................................................
                ............................^.^.^...^...^.^.....^.......^...^.^...^...^.^.....^...^.^.....^.^.^...^.^.^.^.^.....^............................
                .............................................................................................................................................
                ...........................^.^.^...^.^...^.^.^...^.^.^.^.^...^.^.^...^.^.^.^.....^...^...^.^...^...^.^.^...^.^.^.^...........................
                .............................................................................................................................................
                ..........................^...^.......^.^.^.^.^.....^.^.....^.^.^.^.^.^...^.^.......^.^...^.^.^...^...^...^.^.^...^..........................
                .............................................................................................................................................
                .........................^.^.^.^.^...^...^.^.^.^...^.^...^...^...^.^.^.^.^.^.....^...^.^.^.^.^.^.^.....^.^.^.^.....^.........................
                .............................................................................................................................................
                ........................^.^...^.^.^.^.^.^.....^.^.^.^.^...^.^.^...^.^.....^.^.....^...^.....^.^.^.^.^.^.^.^.^.....^.^........................
                .............................................................................................................................................
                .......................^.^.^.^.....^.^.....^.^...^.^...........^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.......................
                .............................................................................................................................................
                ......................^.^.^...^.^...^.^.^.^.^.^.........^.....^.^.....^.^.^.^...^...^...^.^.^.^.^.^.^...^.^.......^.^.^......................
                .............................................................................................................................................
                .....................^.^.^...^.^...^...^.....^.^.^...^.^.^...^.^...^...^...^.^.^.^.^...^.^...^.^.^...^...^.^.^.^.^.....^.....................
                .............................................................................................................................................
                ....................^.^.....^.....^.^.^.^.^.^.^.^.^.^...^...^.^.....^.^.^.^...^...^...^.^.^.^.^...^.^.....^.^...^...^.^.^....................
                .............................................................................................................................................
                ...................^.^...^...^...^.^.........^...^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.^.^...^...^.^.^.^...^.^...................
                .............................................................................................................................................
                ..................^.^.....^.^.^.....^...^.^.^.^.^.^...^.^.....^.^...^...^.^.^...^.^...^.^.^.^.^...^...^.^...^.^.^.^.^...^.^..................
                .............................................................................................................................................
                .................^...^.^...^.^.^...^.....^.^.^.^...^...^...^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.....^...^.^...^...^.^...^.^...^.................
                .............................................................................................................................................
                ................^.......^.^.^...^.^.....^.^.....^...^...^.........^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^...^.^...^...^.^.^.^.^................
                .............................................................................................................................................
                ...............^.^.^.^...^.^...^.^.^.^.......^.^.....^.^.^.^.^.^.^.^.^.....^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^...^...^.^...............
                .............................................................................................................................................
                ..............^.^.....^...^...^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.....^.^.^...^.....^...^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^..............
                .............................................................................................................................................
                .............^.^.^.^.^.^.....^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.....^...^.^.......^...^.^.^.^.....^.^.^.^.^.^.^.....^.^.^.^.............
                .............................................................................................................................................
                ............^...^...^.^.^.......^.^.^...^...^...^.^.^.^...^.^.^.^.....^...^...^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.....^.^...^.^.^............
                .............................................................................................................................................
                ...........^.^.......^.^.^.^.......^.^.^...^...^.^.^.^.^.^.^.^.^.......^.^.^.^.^.^.....^.^...^.^.^.....^.^.^.^...^.^...^.^.^...^.^...........
                .............................................................................................................................................
                ..........^.^...^...^.....^.^.......^.^.^.^.^.^.^.^.^.^...^.^.^.^.....^...^.^.....^.^.^...^.^.....^.......^...^.^.^...^.^.^.^.^.^.^..........
                .............................................................................................................................................
                .........^...^.^.^.^.......^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.......^.^.^...^.^...^.^...^.....^...^.^.^...^.....^.^...^.^.^.^.........
                .............................................................................................................................................
                ........^.^.......^.^.^.^.^.^...^.....^...^.......^.^.^.^...^.^...^.....^.....^.^.....^.^.^.......^.^.^.^.^.....^...^.^...^.^.^.^.^.^........
                .............................................................................................................................................
                .......^.^.^.^.......^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^...^.^.^.^.^.^...^.^...........^.^...^.^...^.^.....^.^.^.......^.^.^...^.^.^.......
                .............................................................................................................................................
                ......^.^...^.^...^.^.^.^.....^...^.^...^.....^.^...^.^.^.....^.^.^.........^.....^.^.....^.^.^.^.^.^...^.^.^...^...^.....^.^.^.^.^.^.^......
                .............................................................................................................................................
                .....^.^.....^.^.^.^.^.^.^...^.^...^...^...^.^.^.....^.^...^.....^...^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.....^.^.^.^.....^.^...^.^.^...^.....
                .............................................................................................................................................
                ....^.^...^.^...^.^.^.^.^.^.^.^.....^...^.......^.^.^.^.^...^.......^.^.^.^.......^.............^.^.^.^.^.^.^...^.^.^.^.....^.^.^.^.....^....
                .............................................................................................................................................
                ...^.^.^.^.^.^.^.^.^.^.^.^...^...^.^...^...^.^.^.^...^.^.^.^.^.^.^...^.^.^...^.....^.^.^.^.^.^.^.^.^.^...^.^...^.^.^.^.....^.^...^.....^.^...
                .............................................................................................................................................
                ..^...^.^.^.^.^...^.^.^.^...^...^...^.^.....^...^.....^.^.....^.^.^...^.^.^...^.^...^...^...^.^.^...^.^...^.^.....^.^...^.^.....^...^...^.^..
                .............................................................................................................................................
                .^.^.......^...^.^...^.^...^.^...^.^.^.^.^.........^.^.......^.^.^.......^.^.^.^.^.^...^.^...^.^.......^.....^.^.^.^.^.^.^.^...^...^.^...^.^.
                .............................................................................................................................................
                """;
        String inputTest = """
                .......S.......
                ...............
                .......^.......
                ...............
                ......^.^......
                ...............
                .....^.^.^.....
                ...............
                ....^.^...^....
                ...............
                ...^.^...^.^...
                ...............
                ..^...^.....^..
                ...............
                .^.^.^.^.^...^.
                ...............
                """;
        // Expected output: 21

        // Quebra linhas
        String[] lines = inputReal.split("\n");
        DaySeven daySeven = new DaySeven();
        ArrayList<ArrayList<String>> matrix = daySeven.convertStringToMatrix(lines);
        daySeven.countDivided(matrix);
        daySeven.printResult();
    }

    ArrayList<ArrayList<String>> convertStringToMatrix(String[] input) {
        ArrayList<ArrayList<String>> matrix = new ArrayList<>();

        //Itera verticalmente - linhas
        for (int i = 0; i < input.length; i++) {
            String[] current = input[i].split("");

            ArrayList<String> newCol = new ArrayList<>();
            matrix.add(i, newCol);

            // Itera horizontalmente - colunas
            Arrays.stream(current).forEach(s -> newCol.add(s));
        }
        return matrix;
    }

    void countDivided(ArrayList<ArrayList<String>> matrix) {
        // Inicia na segunda linha por que a primeira é apenas "S"
        for (int row = 1; row < matrix.size(); row++) {
            for (int col = 0; col < matrix.get(row).size(); col++) {

                //Analisa o que há na linha anterior
                String last = matrix.get(row-1).get(col);
                String current = matrix.get(row).get(col);

                 if (current.equals("^") && last.equals("|")) {
                    // Analisa as extremidadas esquerda e direita antes de editar

                    // Esquerda
                    if (col >= 0) {
                        String left = matrix.get(row).get(col-1);
                         if (left.equals(".")) {
                             matrix.get(row).set(col-1, "|");
                         }
                    }
                    if (col < matrix.get(row).size()) {
                        String right = matrix.get(row).get(col + 1);
                        if (right.equals(".")) {
                            matrix.get(row).set(col + 1, "|");
                        }
                    }
                    this.totalDividedTimes += 1;
                } else if (last.equals("S") || last.equals("|")) {
                    matrix.get(row).set(col, "|");
                }
            }
            System.out.println(matrix.get(row));
        }
    }

    void printResult() {
        System.out.println("Result: " + this.totalDividedTimes);
    }
}


